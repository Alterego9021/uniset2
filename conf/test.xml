<?xml version = '1.0' encoding = 'utf-8' ?>
<UNISETPLC>
<UserData></UserData>

<!-- Общие(стартовые) параметры по UniSet -->
<UniSet>
		<NameService host="localhost" port="2809"/>
		<LocalNode	 name="LocalhostNode"/>
		<RootSection name="UNISET_PLC"/>

		<CountOfNet 		name="1"/>
		<RepeatCount 		name="3"/>
		<RepeatTimeoutMS 	name="50"/>

		<WatchDogTime 		name="0"/> <!-- [мин] -->
		<PingNodeTime 		name="0"/> <!-- [сек] -->
		<AutoStartUpTime 	name="1"/> <!-- [сек] -->
		<DumpStateTime 		name="10"/><!-- [сек] -->
		<SleepTickMS		name="500"/><!-- [мсек] -->

		<!-- Debug, logs -->
		<UniSetDebug name="unideb" levels="crit,warn" file=""/>

		<!-- Если не указано, то считается текущий каталог -->
		<ConfDir name=""/>
		<DataDir name=""/>
		<BinDir name=""/>
		<LogDir name=""/>
		<DocDir name=""/>
		<LockDir name=""/>

	<Services>
		<LocalTimeService name="TimeService" MaxCountTimers="100" AskLifeTimeSEC="10"/>
		<LocalInfoServer name="InfoServer" dbrepeat="1">
			<RouteList>
			</RouteList>
		</LocalInfoServer>
		
		<LocalDBServer name="DBServer" dbnode="" dbname="UNISET_PLC" dbuser="dbadmin" dbpass="dbadmin" pingTime="60000" reconnectTime="30000"/>
		<LocalPrintServer device="/dev/lp0" checkTime="5000" />
	</Services>

</UniSet>

	<dlog name="dlog" levels="" file=""/>
	
	<IOControl name="IOControl" />
	
	<testnode id="1000" />
	
	<SharedMemory name="SharedMemory" shmID="SharedMemory">
		<History savetime="200">
			<item id="1" fuse_id="AlarmFuse1_S" fuse_invert="1" size="30" filter="a1"/>
			<item id="2" fuse_id="AlarmFuse2_AS" fuse_value="2" size="30" filter="a2"/>
		</History>
	</SharedMemory>

	<UniExchange name="UniExchange">
		<item name="UniExchange2" node="Node2" sid_connection=""/>
		<item id="3001" node_id="Node2" sid_connection=""/>
	</UniExchange>

	<MBMaster1 name="MBMaster1" iaddr="127.0.0.1" addr="0x31" port="30000" 
			 levels="info,warn,crit" poll_time="200" reply_timeout="60"
	/>

	<MBSlave1 name="MBSlave1" dev="/dev/ttyS0" addr="0x31" speed="9600" 
			 aftersend-pause="0" levels="info,warn,crit" poll_time="200" reply_timeout="60"
	>
		<filelist>
		<!-- Список файлов разрешённых для передачи по modbus
			directory - каталог где лежит файл. Можно не задавать
				'ConfDir' - берётся из настроек (см. начало этого файла)
				'DataDir' - берётся из настроек (см. начало этого файла)
				'xxx'  - прямое указание каталога
		-->
			<item id="1" name="configure.xml" directory="ConfDir"/>
			<item id="2" name="VERSION" directory="ConfDir"/>
			<item id="3" name="configure.xml.gz" directory="/tmp/"/>
			<item id="4" name="SERIAL" directory="ConfDir"/>
		</filelist>

	</MBSlave1>

	<RTUExchange name="RTUExchange" speed="38400">
		<DeviceList>
			<item addr="0x02" force_disconnect="1" speed="9600" respondSensor="RespondRTU_S" timeout="5000" invert="0"/>
		</DeviceList>
	</RTUExchange>

	<UDPExchange name="UDPExchange"/>
	<UDPExchange2 name="UDPExchange2"/>
	
	<HeartBeatTime time_msec="5000"/>

<ObjectsMap idfromfile="0">
<!--
	Краткие пояснения к полям секции 'sensors'
	==========================================
	node 		- узел на котором физически находится данный датчик
	iotype 		- тип датчика
	priority 	- приоритет сообщения об изменении данного датчика
	textname 	- текстовое имя датчика
-->
	<nodes port="2809">
		<item name="LocalhostNode"	alias="" textname="Локальный узел"	ip="127.0.0.1" infserver="InfoServer" dbserver=""/>
		<item name="Node2"			alias="" textname="Локальный узел"	ip="127.0.0.1" infserver="InfoServer" dbserver=""/>
	</nodes>

	<!-- ************************ Датчики ********************** -->
	<sensors name="Sensors">
		<item name="Input1_S" textname="Команда 1" node="" iotype="DI" priority="Medium" default="1" />
		<item name="Input2_S" textname="Команда 2" node="" iotype="DI" priority="Medium" mbtype="rtu" mbaddr="0x01" mbfunc="0x04" mbreg="0x02" rs="2" />
		<item name="Input3_S" textname="Команда 3" node="" iotype="DI" priority="Medium" 
			  mbtcp="1" tcp_mbtype="rtu" tcp_mbaddr="0x02" tcp_mbfunc="0x06" tcp_mbreg="0x02" tcp_preinit="1" />
		<item name="Input4_S" textname="Команда 4" node="" iotype="DI" priority="Medium" mbtype="rtu" mbaddr="0x02" mbfunc="0x04" mbreg="0x02" rs="2" />
		<item name="Input5_S" textname="Команда 5" node="" iotype="DI" priority="Medium" udp="2"/>
		<item name="Input6_S" textname="Команда 6" node="" iotype="DI" priority="Medium" udp="2">
			<depends>
				<depend name="Input4_S"/>
			</depends>
		</item>
		<item name="DO_C" textname="Digital output" node="" iotype="DO" priority="Medium"/>
		<item name="DO1_C" textname="Digital output" node="" iotype="DO" priority="Medium"/>
		<item name="AO_AS" textname="Analog output" node="" iotype="AO" priority="Medium"
				mbtype="rtu" mbaddr="0x01" mbfunc="0x06" mbreg="0x02" rs="2" default="10" />
		/>
		<item name="AI_AS" textname="Analog input" node="" iotype="AI" default="378" priority="Medium"
				mbtype="rtu" mbaddr="0x01" mbfunc="0x04" mbreg="0x01" rs="1" vtype="F2" precision="45">
			<consumers>
				<consumer name="TestProc" type="objects" cfilter="test1"/>
				<consumer name="PLCProcessor" type="objects"/>
			</consumers>
		</item>
		<item name="Threshold1_S" textname="Порог" node="" iotype="DI" priority="Medium"/>
		<item name="TestMode_S" textname="test" node="" iotype="DI" priority="Medium"/>
		
		<item name="RespondRTU_S" textname="respond rtu" node="" iotype="DI"/>
		<item name="NoRespondRTU2_S" textname="no respond rtu" node="" iotype="DI"/>
		
		<item name="AlarmFuse1_S" textname="alarm fuse sensor 1" node="" iotype="DI" priority="Medium"/>
		<item name="AlarmFuse2_AS" textname="alarm fuse sensor 2" node="" iotype="AI" priority="Medium"/>
		
		<item name="DumpSensor1_S" textname="alarm dumpm sensor 1" a1="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor2_S" textname="alarm dumpm sensor 2" a1="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor3_S" textname="alarm dumpm sensor 3" a1="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor4_S" textname="alarm dumpm sensor 4" a1="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor5_S" textname="alarm dumpm sensor 5" a2="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor6_S" textname="alarm dumpm sensor 6" a2="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor7_S" textname="alarm dumpm sensor 7" a2="1" node="" iotype="DI" priority="Medium"/>
		<item name="DumpSensor8_S" textname="alarm dumpm sensor 8" a2="1" node="" iotype="DI" priority="Medium"/>
		
	</sensors>

	<thresholds name="thresholds">
		<sensor name="AI_AS" node="" iotype="AI">
			<threshold name="t1" lowlimit="374" hilimit="376" sensibility="0" id="1" sid="Threshold1_S">
				<consumers>
					<consumer name="TestProc" type="objects"/>
				</consumers>
			</threshold>
		</sensor>
	</thresholds>

	<controllers name="Controllers">
		<item name="SharedMemory"/>
		<item name="UniExchange"/>
		<item name="UniExchange2"/>
	</controllers>

	<!-- ******************* Идентификаторы сервисов ***************** -->
	<services name="Services">
		<item name="InfoServer"/>
		<item name="DBServer"/>
		<item name="PrintServer"/>
		<item name="TimeService"/>
	</services>

	<!-- ******************* Идентификаторы объектов ***************** -->
	<objects name="UniObjects">
		<item name="TestProc"/>
		<item name="LProcessor"/>
		<item name="IOControl"/>
		<item name="RTUExchange"/>
		<item name="MBSlave1"/>
		<item name="MBMaster1"/>
		<item name="UDPExchange"/>
		<item name="UDPExchange2"/>
	</objects>
</ObjectsMap>

	<messages name="messages" idfromfile="1" >
		<item id="101" name="midMsg1" text="Text for message 1"/>
		<item id="102" name="midMsg2" text="Text for message 2"/>
		<item id="103" name="midMsg3" text="Text for message 3"/>
		<item id="104" name="midMsg4" text="Text for message 4"/>
		<item id="105" name="midMsg5" text="Text for message 5"/>
	</messages>
</UNISETPLC>
